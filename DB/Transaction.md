2020.10.15

**트랜잭션이란?**

논리적인 여러 쿼리를 하나의 작업으로 묶은 단위를 말한다.

하나의 중요한 로직이 진행하던 중에 DB의 오류나 시스템에 의하여서 문제가 발생하였을   경우에 해당 문제를 트랜잭션 단위로 관리하고 있었다면, 정상적으로 진행되지 않았음을   파악하고 해당 로직 이전의 상황으로 되돌릴 수 있다. (롤백)

커밋은 트랜잭션의 내부의 로직이 모두 성공하였을 경우 DB에 내용을 반영하며, 
롤백은 해당 로직 진행중에 문제가 발생하였을 경우 해당 내용의 반영 이전으로 되돌린다.

<br/>

**ACID** 

**Atomicity (원자성) :** 트랜잭션이 안전하게 수행된다는 것을 보장하기 위한 성질

트랜잭션 단위의 작업은 모두 반영되거나 전혀 반영되지 않아야 한다.

<br/>

**Consistency (일관성) :** 트랜잭션 작업처리결과는 항상 일관성 있어야 한다.

데이터베이스는 항상 제약조건에 의하여 하나의 상태로 유지되어야 한다.

<br/>

**Isolation (독립성) :** 둘 이상의 트랜잭션이 동시 실행될 때 어떤 트랜잭션도 다른 트랜잭션의 연산에 끼어들 수 없다 ( 독립적으로 진행되어야 한다. )

**트랜잭션 간의 동기화를 위해 사용하는 것이 Lock 이라는 것이다. 해당 Lock을 하나의 트랜잭션만 점유하고 있는 상태가 된다.** 

<br/>

**Duravility (지속성) :** 트랜잭션이 성공적으로 완료되었다면 결과는 영구히 반영되어야 한다.

<br/>

**DB 구조**

쿼리 처리기 → 로그 캐시 → 데이터 파일

           → 데이터 캐시 →

<br/>

데이터 캐시에 필요한 데이터가 없다면 데이터 파일에서 불러오게 된다.

**쿼리의 처리가 진행됨에 따라 로그 캐시에 로그가 작성된다.**

<br/>

**ReDo 로그 : 변경 후의 값을 기록 , UnDo 로그 : 변경 전의 값을 기록**

( **ReDo 로그에 트랜 잭션 시작 내용도 같이 반영된다. )**

<br/>

**롤백 처리**

Commit 이 진행되기전에 문제가 발생하게 되면 이때 UnDo 로그의 값을 통해 데이터 캐시를 이전으로 돌리게 된다.

Commit 이 진행된다면 데이터 캐시에 반영된 결과가 DB에 적용된다.

<br/>

**예상치 못한 에러 발생 (시스템 다운, 전원 나감 등)**

ReDo 로그를 통해 데이터들을 일관성 있게 설정하고 UnDo 로그를 통하여 필요없는 데이터를 원복시킨다.

<br/>

출처 :
https://www.youtube.com/watch?v=ImvYNlF_saE&ab_channel=%EC%9A%B0%EC%95%84%ED%95%9CTech